import{F as FetchLoader,_ as _export_sfc,i as isPlainObject,V as VBlock,a as VColumn,b as VButton,c as VText,d as VInput,e as VTag,f as VImage,g as VDivider}from"./index.c94b70a8.js";import{o as openBlock,a as createElementBlock,b as renderSlot,k as createTextVNode,t as toDisplayString,K as createCommentVNode,d as createBaseVNode,s as h,r as resolveComponent,F as Fragment,j as renderList,c as createBlock,h as createVNode}from"./vendor.5f2be16e.js";const loader=new FetchLoader({styleIsolation:!0}),DELAY_LOADING_TIME=200,_sfc_main$3={name:"Custom",props:{moduleData:{type:Object,validator(t){return isPlainObject(t)}},ctx:{type:Object,default:()=>{},validator(t){return isPlainObject(t)}}},data(){return{loading:!1,delaying:!0,error:null}},mounted(){this.load().then(t=>{const s=t.mount(document.createElement("div"),this.ctx);this.$nextTick(()=>{this.$refs.content.append(s.el)})}).catch(t=>{this.loading=!1,this.timer&&window.clearTimeout(this.timer),this.error=t})},methods:{load(){return this.timer=setTimeout(()=>{this.loading=!0,this.delaying=!1},DELAY_LOADING_TIME),new Promise((t,s)=>{const i=o=>{this.loading=!1,this.timer&&window.clearTimeout(this.timer),o&&o.mount?t(o):(this.error={msg:"mod or mod.mount not found!"},s(this.error))},a=o=>{this.loading=!1,this.timer&&window.clearTimeout(this.timer),this.error=o,s(o)};loader.fetch(this.moduleData.js,i,a)})}}},_hoisted_1$2={key:0},_hoisted_2=createBaseVNode("div",{style:{color:"#ccc"}},"loading...",-1),_hoisted_3={key:1},_hoisted_4={ref:"content"};function _sfc_render$2(t,s,i,a,o,n){return openBlock(),createElementBlock("div",null,[o.loading?(openBlock(),createElementBlock("div",_hoisted_1$2,[renderSlot(t.$slots,"loading",{},()=>[_hoisted_2])])):o.error?(openBlock(),createElementBlock("div",_hoisted_3,[renderSlot(t.$slots,"error",{},()=>[createTextVNode(toDisplayString(o.error),1)])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_4,null,512)])}var Custom=_export_sfc(_sfc_main$3,[["render",_sfc_render$2]]);const _sfc_main$2={name:"ViewItem",components:{VBlock,VColumn,VButton,VText,VInput,VTag,VImage,VDivider,Custom},props:{item:{type:Object}},methods:{getModuleData(t){return{js:{[`${t.name}_${t.version}`]:t.url}}}},render(){const{item:_item}=this,genRender=t=>{if(t.isCustom)return h(Custom,{moduleData:this.getModuleData(t.customData)});const s={},a=(t.children||[]).reduce((o,n)=>(o[n.slotName]?o[n.slotName].push(n):o[n.slotName]=[n],o),{});return Object.keys(a).forEach(o=>{const n=a[o];s[o]=()=>n.map(r=>r.isCustom?h(Custom,{moduleData:this.getModuleData(r.customData)}):(handleEvents(r.props),h(resolveComponent(r.name),r.props,{default:()=>genRender(r)})))}),handleEvents(t.props),h(resolveComponent(t.name),t.props,s)},handleEvents=props=>{const{events}=props;for(let evtName in events){const code=events[evtName];props[`${evtName}`]=e=>{eval(`(${code})(e)`)}}};return genRender(_item)}},_sfc_main$1={name:"DesignerView",components:{ViewItem:_sfc_main$2},props:{data:{type:Array}}},_hoisted_1$1={class:"designer-view"};function _sfc_render$1(t,s,i,a,o,n){const r=resolveComponent("ViewItem");return openBlock(),createElementBlock("div",_hoisted_1$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(i.data,(c,l)=>(openBlock(),createBlock(r,{item:c,key:l},null,8,["item"]))),128))])}var DesignerView=_export_sfc(_sfc_main$1,[["render",_sfc_render$1]]);const _sfc_main={name:"Preview",components:{VButton,DesignerView},setup(){let t=localStorage.getItem("viewModel");return t?t=JSON.parse(t).children:t=[],console.log(t),{data:t}}},_hoisted_1={class:"preview"};function _sfc_render(t,s,i,a,o,n){const r=resolveComponent("DesignerView");return openBlock(),createElementBlock("div",_hoisted_1,[createVNode(r,{data:a.data},null,8,["data"])])}var Preview=_export_sfc(_sfc_main,[["render",_sfc_render]]);export{Preview as default};
